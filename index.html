<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIP Calculator with Advanced Features</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.6.0/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        .glass-effect {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(12px) saturate(180%);
            -webkit-backdrop-filter: blur(12px) saturate(180%);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        body {
            background: linear-gradient(to bottom right, #f8fafc, #e2e8f0);
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .invested-amount {
            border-left: 5px solid #4ade80;
        }
        .estimated-returns {
            border-left: 5px solid #3b82f6;
        }
        .total-value {
            border-left: 5px solid #9333ea;
        }
        .hover-effect {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .hover-effect:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-4">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-2 text-indigo-600">SIP CalC</h1>
            <p class="text-sm opacity-90 text-gray-600">Calculate your Systematic Investment Plan returns with top-up and year-wise breakdown</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
            <!-- Input Section-->
            <div class="bg-gray-100 p-6 lg:col-span-2 shadow-lg rounded-xl border border-gray-200 hover:shadow-xl transition-shadow">
                <h2 class="text-2xl font-semibold mb-4 text-center text-indigo-600">Investment Details</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block mb-1 text-sm text-blue-800">Monthly Investment (₹)</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-blue-600">₹</span>
                            <input type="number" id="monthlyInvestment" class="w-full pl-8 p-3 rounded-lg bg-white-500 bg-opacity-50 border border-gray-700 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 transition-all duration-300" value="5000">
                        </div>
                    </div>
                    <div>
                        <label class="block mb-1 text-sm text-blue-800">Investment Period (Years)</label>
                        <input type="number" id="investmentPeriod" class="w-full p-3 rounded-lg bg-white-600 border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500" value="10">
                    </div>
                    <div>
                        <label class="block mb-1 text-sm text-blue-800">Expected Return Rate (% p.a.)</label>
                        <input type="number"  id="expectedReturn" class="w-full p-3 rounded-lg bg-white-700 bg-opacity-50 border border-gray-700 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500" value="12">
                    </div>
                    <div>
                        <label class="block mb-1 text-sm text-blue-800">Top-up Percentage (% p.a.)</label>
                        <input type="number" id="topUpPercentage" class="w-full p-3 rounded-lg bg-white-800 bg-opacity-50 border border-gray-700 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500" value="10">
                        <p class="text-xs mt-1 opacity-80">Your SIP amount will increase by this percentage every year</p>
                    </div>
                    <div class="text-center">
                    <button onclick="calculateSIP()" class="w-60 bg-indigo-400 hover:bg-indigo-700 text-white py-2 px-4 rounded-lg font-medium transition duration-200 text-center">
                        Calculate
                    </button>
                    </div>

                </div>
            </div> 

            <!-- Results Section -->
            <div class="bg-white-200 p-6 lg:col-span-3 shadow-lg rounded-xl border border-gray-200">
                <!-- Multi-Fund Comparison Section -->
                <!-- <div class="mb-8 p-4 bg-indigo-400 bg-opacity-30 rounded-lg">
                    <h3 class="text-xl font-semibold mb-3">Compare Multiple Funds</h3>
                    <div class="flex flex-wrap gap-3 mb-4" id="fundInputs">
                        <div class="flex-grow">
                            <select class="w-full p-2 rounded-lg bg-gray-700 border border-gray-600">
                                <option>Select Fund 1</option>
                                <option>Large Cap Equity Fund</option>
                                <option>Mid Cap Fund</option>
                                <option>Small Cap Fund</option>
                            </select>
                        </div>
                        <button onclick="addFundInput()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg">
                            + Add Fund
                        </button>
                    </div>
                    <div class="relative h-64">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div> -->

                <div class="flex justify-between items-center mb-6">

                    <div class="flex bg-blue-500 rounded-lg ">
                        <h3 class="px-20 py-1 font-medium text-center text-white text-lg">SIP Growth Results</h3>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="exportToPDF()" class="bg-pink-600 hover:bg-pink-700 text-white py-2 px-3 rounded-lg text-sm transition duration-200">
                            Export PDF
                        </button>
                        <button onclick="exportToExcel()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-3 rounded-lg text-sm transition duration-200">
                            Export Excel
                        </button>
                    </div>
                </div>

                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-cyan-500 p-4 rounded-lg shadow-sm invested-amount border border-gray-200">
                        <p class="text-black text-sm font-bold">Invested Amount</p>
                        <p id="totalInvested" class="text-xl font-bold text-white">₹0</p>
                    </div>
                    <div class="bg-green-600 p-4 rounded-lg shadow-sm estimated-returns border border-gray-200">
                        <p class="text-black text-sm font-bold">Estimated Returns</p>
                        <p id="estimatedReturns" class="text-xl font-bold text-white">₹0</p>
                    </div>
                    <div class="bg-indigo-500 bg-opacity-80 p-4 rounded-lg total-value">
                        <p class="text-white text-sm font-bold">Total Value</p>
                        <p id="totalValue" class="text-xl font-bold text-black">₹0</p>
                    </div>
                </div>

                <!-- Chart -->
                <div class="mb-6 bg-gradient-to-r from-gray-600 to-gray-900 rounded-lg shadow-lg">
                    <canvas id="sipChart" height="250" class="w-full"></canvas>
                </div>

                <!-- Year-wise Breakdown -->
                <div class="overflow-x-auto">
                    <div class="p-1 mb-3 bg-blue-500 rounded-lg ">
                        <h3 class="text-lg font-medium mb-3 text-center text-white">Year-wise Breakdown</h3>
                    </div>
                    <table class="w-full  rounded-lg overflow-hidden shadow">
                        <thead>
                            <tr>
                                <th class="p-3 text-center rounded-lg bg-gray-600 text-white">Year</th>
                                <th class="p-3 text-center rounded-lg bg-cyan-500 text-white">Invested</th>
                                <th class="p-3 text-center rounded-lg bg-green-500 text-white">Returns</th>
                                <th class="p-3 text-center rounded-lg bg-indigo-400 text-white">Total Value</th>
                            </tr>
                        </thead>
                        <tbody id="yearlyBreakdown" class="divide-y rounded-lg bg-gray-400">
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <footer class="mt-12 text-center text-sm text-white p-6 bg-gray-700 rounded-lg">
            <p class="mb-4">Disclaimer: This calculator provides estimates only. Actual returns may vary. Past performance is not indicative of future returns.</p>
            <p class="mb-2 text-xs">Mutual fund investments are subject to market risks. Read all scheme-related documents carefully.</p>
            <p class="mb-2 text-xs">This tool is for educational purposes only and not intended as investment advice.</p>
            <p class="mb-2 text-xs">All calculations are based on the inputs provided and assumptions about returns.</p>
            <p class="text-xs mt-4">Developed by Dipankar Adhikary | Not affiliated with any financial institution.</p>
            <p class="text-xs mt-2">Dipankar Adhikary is not liable for any discrepancies or losses arising from the use of this calculator.</p>
            <p class="text-xs mt-2">© 2025 SIP Calculator | All rights reserved</p>
        </footer>
    </div>

    <script>
        let sipChart = null;
        let calculatedData = null;

        function calculateSIP() {
            const monthlyInvestment = parseFloat(document.getElementById('monthlyInvestment').value) || 0;
            const investmentPeriod = parseInt(document.getElementById('investmentPeriod').value) || 0;
            const expectedReturn = parseFloat(document.getElementById('expectedReturn').value) || 0;
            const topUpPercentage = parseFloat(document.getElementById('topUpPercentage').value) || 0;

            const monthlyRate = expectedReturn / 12 / 100;
            let currentMonthlyInvestment = monthlyInvestment;
            let totalInvested = 0;
            let totalValue = 0;
            let yearlyData = [];
            
            for (let year = 1; year <= investmentPeriod; year++) {
                let yearInvested = 0;
                let yearStartValue = totalValue;
                
                // Calculate for each month in the year
                for (let month = 1; month <= 12; month++) {
                    totalInvested += currentMonthlyInvestment;
                    yearInvested += currentMonthlyInvestment;
                    
                    // Calculate returns on previous balance
                    if (month > 1 || year > 1) {
                        totalValue = totalValue * (1 + monthlyRate);
                    }
                    
                    // Add current month's investment
                    totalValue += currentMonthlyInvestment;
                }
                
                // Apply top-up for next year
                if (year < investmentPeriod) {
                    currentMonthlyInvestment = currentMonthlyInvestment * (1 + (topUpPercentage / 100));
                }
                
                // Store year data
                const yearReturns = totalValue - yearStartValue - yearInvested;
                yearlyData.push({
                    year,
                    invested: yearInvested,
                    returns: yearReturns,
                    totalValue: totalValue
                });
            }
            
            const estimatedReturns = totalValue - totalInvested;
            
            // Update summary
            document.getElementById('totalInvested').textContent = '₹' + formatNumber(totalInvested);
            document.getElementById('estimatedReturns').textContent = '₹' + formatNumber(estimatedReturns);
            document.getElementById('totalValue').textContent = '₹' + formatNumber(totalValue);
            
            // Update yearly breakdown
            updateYearlyBreakdown(yearlyData);
            
            // Update chart
            updateChart(yearlyData);
            
            // Store calculated data for export
            calculatedData = {
                monthlyInvestment,
                investmentPeriod,
                expectedReturn,
                topUpPercentage,
                totalInvested,
                estimatedReturns,
                totalValue,
                yearlyData
            };
        }
        
        function updateYearlyBreakdown(yearlyData) {
            const tbody = document.getElementById('yearlyBreakdown');
            tbody.innerHTML = '';
            
            yearlyData.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-indigo-600 hover:bg-opacity-70 rounded-lg text-white';
                row.innerHTML = `
                    <td class="p-3 text-center rounded-[14px]">${data.year}</td>
                    <td class="p-3 text-center rounded-lg">₹${formatNumber(data.invested)}</td>
                    <td class="p-3 text-center rounded-lg">₹${formatNumber(data.returns)}</td>
                    <td class="p-3 text-center rounded-lg">₹${formatNumber(data.totalValue)}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function updateChart(yearlyData) {
            const ctx = document.getElementById('sipChart').getContext('2d');
            
            // Destroy previous chart if it exists
            if (sipChart) {
                sipChart.destroy();
            }
            
            // Prepare data for chart
            const labels = yearlyData.map(data => `Year ${data.year}`);
            const investedData = yearlyData.map(data => data.invested);
            const returnsData = yearlyData.map(data => data.returns);
            
            sipChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Invested Amount',
                            data: investedData,
                            backgroundColor: 'rgba(74, 222, 128, 0.7)',
                            borderColor: 'rgba(74, 222, 128, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Estimated Returns',
                            data: returnsData,
                            backgroundColor: 'rgba(59, 130, 246, 0.7)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: 'rgba(255, 255, 255, 0.9)'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ₹' + formatNumber(context.raw);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            stacked: true,
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return '₹' + formatNumber(value);
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }
        
        function formatNumber(num) {
            return num.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        function exportToPDF() {
            if (!calculatedData) {
                alert('Please calculate SIP first');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });
            
            // Add title
            doc.setFontSize(20);
            doc.text('SIP Investment Report', 105, 20, { align: 'center' });
            
            // Add summary
            doc.setFontSize(12);
            doc.text('Input Parameters:', 15, 30);
            doc.text(`Monthly Investment: ${formatNumber(calculatedData.monthlyInvestment)}`, 15, 40);
            doc.text(`Investment Period: ${calculatedData.investmentPeriod} years`, 15, 45);
            doc.text(`Expected Return: ${calculatedData.expectedReturn}% p.a.`, 15, 50);
            doc.text(`Top-up Percentage: ${calculatedData.topUpPercentage}% p.a.`, 15, 55);
            
            doc.text('Summary Results:', 15, 70);
            doc.text(`Total Invested Amount: ${formatNumber(calculatedData.totalInvested)}`, 15, 80);
            doc.text(`Estimated Returns: ${formatNumber(calculatedData.estimatedReturns)}`, 15, 85);
            doc.text(`Total Value: ${formatNumber(calculatedData.totalValue)}`, 15, 90);
            
            // Add chart image placeholder
            doc.setFillColor(240, 240, 240);
            doc.rect(15, 105, 180, 80, 'F');
            doc.setTextColor(100, 100, 100);
            doc.text('Investment Growth Chart', 105, 145, { align: 'center' });
            
            // Add yearly breakdown table
            const headers = ['Year', 'Invested', 'Returns', 'Total Value'];
            const data = calculatedData.yearlyData.map(row => [
                row.year,
                formatNumber(row.invested),
                formatNumber(row.returns),
                formatNumber(row.totalValue)
            ]);
            
            doc.autoTable({
                head: [headers],
                body: data,
                startY: 125,
                styles: {
                    cellPadding: 5,
                    fontSize: 10,
                    valign: 'middle',
                    halign: 'center' 
                },
                headStyles: {
                    fillColor: [30, 64, 175],
                    textColor: 255,
                    fontSize: 10,
                    fontStyle: 'bold',
                    halign: 'center'
                },
                bodyStyles: {
                    textColor: [31, 41, 55],
                    cellPadding: 4
                },
                columnStyles: {
                    0: { halign: 'center' }, // Year column
                    1: { halign: 'center' }, // Invested column
                    2: { halign: 'center' }, // Returns column
                    3: { halign: 'center' } // Total Value column
                },
                margin: { top: 125 }
            });

            // Add Desclaimer
            doc.setFontSize(8);
            doc.text('Disclaimer: This calculator provides estimates only. Actual returns may vary. Past performance is not indicative of future returns.
                Mutual fund investments are subject to market risks. Read all scheme-related documents carefully.
                This tool is for educational purposes only and is not intended as investment advice.
                All calculations are based on the inputs provided and assumptions about returns.
                Developed by Dipankar Adhikary | Not affiliated with any financial institution.
                Dipankar Adhikary is not liable for any discrepancies or losses arising from the use of this calculator.', 15, 90);
            
            // Save PDF
            doc.save('SIP-Report.pdf');
        }
        
        function exportToExcel() {
            if (!calculatedData) {
                alert('Please calculate SIP first');
                return;
            }
            
            // Create data array
            const data = [
                ['SIP Investment Report'],
                [''],
                ['Input Parameters:'],
                ['Monthly Investment', `₹${formatNumber(calculatedData.monthlyInvestment)}`],
                ['Investment Period', `${calculatedData.investmentPeriod} years`],
                ['Expected Return', `${calculatedData.expectedReturn}% p.a.`],
                ['Top-up Percentage', `${calculatedData.topUpPercentage}% p.a.`],
                [''],
                ['Summary Results:'],
                ['Total Invested Amount', `₹${formatNumber(calculatedData.totalInvested)}`],
                ['Estimated Returns', `₹${formatNumber(calculatedData.estimatedReturns)}`],
                ['Total Value', `₹${formatNumber(calculatedData.totalValue)}`],
                [''],
                ['Year-wise Breakdown:'],
                ['Year', 'Invested', 'Returns', 'Total Value'],
                ...calculatedData.yearlyData.map(row => [
                    row.year,
                    '₹' + formatNumber(row.invested),
                    '₹' + formatNumber(row.returns),
                    '₹' + formatNumber(row.totalValue)
                ])
            ];
            
            // Create workbook and worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // Calculate range for borders
            const range = XLSX.utils.decode_range(ws['!ref']);
            
            // Apply styling to headers and title
            for (let C = range.s.c; C <= range.e.c; ++C) {
                if (C === 0 || data[range.s.r][C] === 'Year') {
                    // Make headers bold
                    const cell_address = { c: C, r: range.s.r };
                    const cell_ref = XLSX.utils.encode_cell(cell_address);
                    ws[cell_ref].s = { font: { bold: true } };
                }
            }
            
            // Add worksheet to workbook
            XLSX.utils.book_append_sheet(wb, ws, "SIP Report");
            
            // Export
            XLSX.writeFile(wb, 'SIP-Report.xlsx');
        }
        
        // Fund Comparison Functions
        function addFundInput() {
            const container = document.getElementById('fundInputs');
            const count = container.querySelectorAll('select').length + 1;
            
            if(count > 3) {
                alert('Maximum 3 funds can be compared');
                return;
            }

            const div = document.createElement('div');
            div.className = 'flex-grow';
            div.innerHTML = `
                <select class="w-full p-2 rounded-lg bg-gray-700 border border-gray-600">
                    <option>Select Fund ${count}</option>
                    <option>Large Cap Equity Fund</option>
                    <option>Mid Cap Fund</option>
                    <option>Small Cap Fund</option>
                    <option>Index Fund</option>
                    <option>Sectoral Fund</option>
                </select>
            `;
            container.insertBefore(div, container.lastElementChild);
        }

        // Initialize the calculator on page load
        window.onload = function() {
            calculateSIP();
            // Initialize comparison chart
            new Chart(document.getElementById('comparisonChart').getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['1Y', '3Y', '5Y', '7Y', '10Y'],
                    datasets: []
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        };
    </script>
</body>
</html>

